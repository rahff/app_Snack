(self.webpackChunksnack=self.webpackChunksnack||[]).push([[195],{1195:(t,e,n)=>{"use strict";n.r(e),n.d(e,{UserModule:()=>O});var i=n(3722),o=n(7272),r=n(736);let s=(()=>{class t{constructor(t){this.userService=t}canActivate(){return!!this.userService.jwtToken$.value.isAuth}}return t.\u0275fac=function(e){return new(e||t)(o.LFG(r.K))},t.\u0275prov=o.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var a=n(7790),c=n(6274);function d(t,e){if(1&t&&(o.TgZ(0,"div",7),o._uU(1),o.qZA()),2&t){const t=e.$implicit;o.xp6(1),o.AsE("",t.quantity," ",t.product," ")}}function l(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div",1),o.TgZ(1,"div",2),o.TgZ(2,"div",3),o._uU(3),o.ALo(4,"date"),o.qZA(),o.TgZ(5,"div",4),o.TgZ(6,"div",5),o._uU(7,"D\xe9tail commande :"),o.qZA(),o.YNc(8,d,2,2,"div",6),o.qZA(),o.TgZ(9,"div",4),o.TgZ(10,"div",5),o._uU(11,"Num\xe9ro de commande :"),o.qZA(),o.TgZ(12,"div",7),o._uU(13),o.qZA(),o.qZA(),o.TgZ(14,"div",4),o.TgZ(15,"div",5),o._uU(16,"Montant :"),o.qZA(),o.TgZ(17,"div",7),o._uU(18),o.qZA(),o.qZA(),o.qZA(),o.TgZ(19,"div",8),o.TgZ(20,"button",9),o.NdJ("click",function(){o.CHM(t);const n=e.index;return o.oxw().refreshCommande(n)}),o._uU(21,"Commander \xe0 nouveau"),o.qZA(),o.qZA(),o.qZA()}if(2&t){const t=e.$implicit;o.xp6(3),o.hij("commande du ",o.xi3(4,4,t.date,"dd/MM/yyyy")," "),o.xp6(5),o.Q6J("ngForOf",t.detail),o.xp6(5),o.hij(" ",t.numeroCommande," "),o.xp6(5),o.hij("",t.montant," \u20ac")}}let u=(()=>{class t{constructor(t,e,n){this.userService=t,this.cartService=e,this.router=n,this.commandes=[]}ngOnInit(){this.subscription=this.userService.currentUser$.subscribe(t=>{this.commandes=t.commandes,console.log("commandes",t.commandes)})}refreshCommande(t){this.cartService.refreshCommande(this.commandes[t].detail),this.router.navigate(["/page-menu/panier"])}ngOnDestroy(){this.subscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(r.K),o.Y36(a.N),o.Y36(i.F0))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-list-commande-user"]],decls:3,vars:1,consts:[["class","container",4,"ngFor","ngForOf"],[1,"container"],[1,"flex-col","w-100"],[1,"date"],[1,"row"],[1,"label"],["class","detail",4,"ngFor","ngForOf"],[1,"detail"],[1,"action"],[1,"btn","success",3,"click"]],template:function(t,e){1&t&&(o.TgZ(0,"h1"),o._uU(1,"Historique de vos commandes"),o.qZA(),o.YNc(2,l,22,7,"div",0)),2&t&&(o.xp6(2),o.Q6J("ngForOf",e.commandes))},directives:[c.sg],pipes:[c.uU],styles:["@media screen and (min-width:551px){.container[_ngcontent-%COMP%]{padding:25px;border:1px solid var(--success);border-radius:20px;margin-bottom:15px;font-size:28px;position:relative}.date[_ngcontent-%COMP%]{padding:10px 0;width:70%;justify-content:center;align-items:center;margin:0 auto 20px}.date[_ngcontent-%COMP%], .row[_ngcontent-%COMP%]{display:flex}.row[_ngcontent-%COMP%]{flex-wrap:wrap;margin-bottom:5px}.detail[_ngcontent-%COMP%], .label[_ngcontent-%COMP%]{padding:15px}.detail[_ngcontent-%COMP%]{border:1px solid var(--success);border-radius:20px;margin-right:2px;margin-bottom:2px}h1[_ngcontent-%COMP%]{color:var(--warning);font-size:50px;margin-bottom:45px}.vide[_ngcontent-%COMP%]{font-size:35px;text-align:center;padding:30px}.action[_ngcontent-%COMP%]{margin:15px auto 0;display:flex;justify-content:flex-end;align-items:flex-end}.action[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:25px}}@media screen and (max-width:551px){.container[_ngcontent-%COMP%]{padding:20px;border:1px solid var(--success);border-radius:20px;margin-bottom:15px;font-size:20px;position:relative}.date[_ngcontent-%COMP%]{padding:10px 0;width:70%;justify-content:center;align-items:center;margin:0 auto 20px}.date[_ngcontent-%COMP%], .row[_ngcontent-%COMP%]{display:flex}.row[_ngcontent-%COMP%]{flex-wrap:wrap;margin-bottom:5px;width:100%}.detail[_ngcontent-%COMP%], .label[_ngcontent-%COMP%]{padding:10px}.detail[_ngcontent-%COMP%]{border:1px solid var(--success);border-radius:20px;margin-right:2px;margin-bottom:2px}h1[_ngcontent-%COMP%]{color:var(--warning);font-size:50px;margin-bottom:45px}.vide[_ngcontent-%COMP%]{font-size:35px;text-align:center;padding:20px}.action[_ngcontent-%COMP%]{margin:15px auto 0;display:flex;justify-content:flex-end;align-items:flex-end;position:absolute;bottom:10px;right:10px}.action[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:20px}}"]}),t})();var p=n(4988),g=n(213);const m=["newName"];function f(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div",17),o._UZ(1,"input",18,19),o.TgZ(3,"button",20),o.NdJ("click",function(){return o.CHM(t),o.oxw().submitOneField("name",0)}),o._uU(4,"Ok"),o.qZA(),o.qZA()}if(2&t){const t=o.oxw();o.xp6(1),o.s9C("value",t.userName)}}function x(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div",17),o._UZ(1,"input",18,19),o.TgZ(3,"button",20),o.NdJ("click",function(){return o.CHM(t),o.oxw().submitOneField("firstname",1)}),o._uU(4,"Ok"),o.qZA(),o.qZA()}if(2&t){const t=o.oxw();o.xp6(1),o.s9C("value",t.userFirstname)}}function h(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div",17),o._UZ(1,"input",18,19),o.TgZ(3,"button",20),o.NdJ("click",function(){return o.CHM(t),o.oxw().submitOneField("email",2)}),o._uU(4,"Ok"),o.qZA(),o.qZA()}if(2&t){const t=o.oxw();o.xp6(1),o.s9C("value",t.userEmail)}}function _(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div",21),o._UZ(1,"input",18,19),o.TgZ(3,"button",20),o.NdJ("click",function(){return o.CHM(t),o.oxw().submitOneField("adress",3)}),o._uU(4,"Ok"),o.qZA(),o.qZA()}if(2&t){const t=o.oxw();o.xp6(1),o.s9C("value",t.userAdress)}}function b(t,e){if(1&t){const t=o.EpF();o.TgZ(0,"div",12),o.TgZ(1,"div",22),o.TgZ(2,"label"),o._uU(3,"Mot de passe"),o.qZA(),o._UZ(4,"input",23),o.TgZ(5,"label"),o._uU(6,"Nouveau mot de passe"),o.qZA(),o._UZ(7,"input",24),o.TgZ(8,"label"),o._uU(9,"Confirmer"),o.qZA(),o.TgZ(10,"input",25),o.NdJ("input",function(){return o.CHM(t),o.oxw().errorPassword=!1}),o.qZA(),o.TgZ(11,"button",26),o.NdJ("click",function(){return o.CHM(t),o.oxw().submitOneField("password",4)}),o._uU(12,"Modifier le mot de passe"),o.qZA(),o.qZA(),o.qZA()}if(2&t){const t=o.oxw();o.xp6(1),o.Q6J("formGroup",t.updatePasswordForm)}}function M(t,e){1&t&&(o.TgZ(0,"p",27),o._uU(1,"Les mots de passe sont diff\xe9rents"),o.qZA())}function Z(t,e){if(1&t&&(o.TgZ(0,"p",27),o._uU(1),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.Oqu(t.errorServer)}}function v(t,e){if(1&t&&(o.TgZ(0,"p",27),o._uU(1),o.qZA()),2&t){const t=o.oxw();o.xp6(1),o.hij(" ",t.messageSuccess," ")}}const C=[{path:"",canActivate:[s],component:(()=>{class t{constructor(t,e,n){this.userService=t,this.fb=e,this.alertService=n,this.isModif=!1,this.errorPassword=!1}ngOnInit(){this.userService.getCurrentUser().subscribe(t=>{this.userName=t.name,this.userFirstname=t.firstname,this.userAdress=t.adress,this.userEmail=t.email,this.userId=t._id}),this.initForm()}updateField(t,e){const n=document.querySelectorAll(".se");if(this.isModif){this.name=void 0,this.isModif=!1;for(let t=0;t<5;t++)n[t].innerHTML="Modifier <i class='bi bi-pencil-fill'></i>",n[t].removeAttribute("disabled")}else{this.name=t,this.isModif=!this.isModif;for(let t=0;t<5;t++)n[t].innerHTML=t===e?"Annuler <i class='bi bi-skip-backward-btn'></i>":"Modifier <i class='bi bi-pencil-fill'></i>",t!==e&&n[t].setAttribute("disabled","true")}}submitOneField(t,e){if("password"===t){if(this.updatePasswordForm.get("new").value!==this.updatePasswordForm.get("confirm").value)return void(this.errorPassword=!0);const n={old:this.updatePasswordForm.get("old").value,new:this.updatePasswordForm.get("new").value,email:this.userEmail};return console.log(this.userId),this.userService.updateOneField(this.userId,t,n).then(t=>{this.alertService.makeSimpleAlert(t.message,"success",1800)}).catch(t=>{this.alertService.makeSimpleAlert(t,"error",1800)}),void this.updateField(t,e)}this.userService.updateOneField(this.userId,t,{update:this.newName.nativeElement.value}).then(t=>{const e={email:t.result.local.email,name:t.result.name,adress:t.result.adress,firstname:t.result.firstname,role:t.result.role,confirm:t.result.confirm,_id:t.result._id};this.userService.currentUser$.next(e),this.userName=e.name,this.userFirstname=e.firstname,this.userAdress=e.adress,this.userEmail=e.email,this.alertService.makeSimpleAlert(t.message,"success",1800)}).catch(t=>(console.log("echec"),this.alertService.makeSimpleAlert(t,"error",1800),t)),this.updateField(t,e)}initForm(){this.updatePasswordForm=this.fb.group({old:["",p.kI.required],new:["",p.kI.required,p.kI.minLength(6)],confirm:["",p.kI.required]})}}return t.\u0275fac=function(e){return new(e||t)(o.Y36(r.K),o.Y36(p.qu),o.Y36(g.c))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-profil"]],viewQuery:function(t,e){if(1&t&&o.Gf(m,1),2&t){let t;o.iGM(t=o.CRH())&&(e.newName=t.first)}},decls:51,vars:12,consts:[[1,"container"],[1,"profil-item"],[1,"btn","success","se",3,"click"],["butt1",""],[1,"bi","bi-pencil-fill"],["class","updateField",4,"ngIf"],["butt2",""],["butt3",""],[1,"profil-item","last-child"],["butt4",""],["class","updateField last-child",4,"ngIf"],["id","password",1,"profil-item"],[1,"d-flex"],["class","d-flex",4,"ngIf"],["class","error",4,"ngIf"],[1,"flex-center"],["routerLink","list-commande",1,"btn","success"],[1,"updateField"],["type","text",3,"value"],["newName",""],[1,"btn","btn-danger",3,"click"],[1,"updateField","last-child"],[1,"flex-col",3,"formGroup"],["type","password","value","","formControlName","old"],["type","password","value","","formControlName","new"],["type","password","value","","formControlName","confirm",3,"input"],["id","updatePassword",1,"btn","btn-danger",3,"click"],[1,"error"]],template:function(t,e){1&t&&(o.TgZ(0,"h1"),o._uU(1,"Votre Profil Client"),o.qZA(),o.TgZ(2,"div",0),o.TgZ(3,"ul"),o.TgZ(4,"li",1),o._uU(5),o.TgZ(6,"button",2,3),o.NdJ("click",function(){return e.updateField("name",0)}),o._uU(8," Modifier "),o._UZ(9,"i",4),o.qZA(),o.YNc(10,f,5,1,"div",5),o.qZA(),o._UZ(11,"hr"),o.TgZ(12,"li",1),o._uU(13),o.TgZ(14,"button",2,6),o.NdJ("click",function(){return e.updateField("firstname",1)}),o._uU(16," Modifier "),o._UZ(17,"i",4),o.qZA(),o.YNc(18,x,5,1,"div",5),o.qZA(),o._UZ(19,"hr"),o.TgZ(20,"li",1),o._uU(21),o.TgZ(22,"button",2,7),o.NdJ("click",function(){return e.updateField("email",2)}),o._uU(24," Modifier "),o._UZ(25,"i",4),o.qZA(),o.YNc(26,h,5,1,"div",5),o.qZA(),o._UZ(27,"hr"),o.TgZ(28,"li",8),o._uU(29),o.TgZ(30,"button",2,9),o.NdJ("click",function(){return e.updateField("adress",3)}),o._uU(32," Modifier"),o._UZ(33,"i",4),o.qZA(),o.YNc(34,_,5,1,"div",10),o.qZA(),o._UZ(35,"hr"),o.TgZ(36,"li",11),o.TgZ(37,"div",12),o._uU(38,"Mot de passe: ******** "),o.TgZ(39,"button",2,7),o.NdJ("click",function(){return e.updateField("password",4)}),o._uU(41," Modifier "),o._UZ(42,"i",4),o.qZA(),o.qZA(),o.YNc(43,b,13,1,"div",13),o.YNc(44,M,2,0,"p",14),o.YNc(45,Z,2,1,"p",14),o.YNc(46,v,2,1,"p",14),o.qZA(),o._UZ(47,"hr"),o.TgZ(48,"div",15),o.TgZ(49,"button",16),o._uU(50,"Historique des commandes"),o.qZA(),o.qZA(),o.qZA(),o.qZA()),2&t&&(o.xp6(5),o.hij(" Nom: ",e.userName," "),o.xp6(5),o.Q6J("ngIf",e.isModif&&"name"===e.name),o.xp6(3),o.hij(" Pr\xe9nom: ",e.userFirstname,""),o.xp6(5),o.Q6J("ngIf",e.isModif&&"firstname"===e.name),o.xp6(3),o.hij(" Email: ",e.userEmail,""),o.xp6(5),o.Q6J("ngIf",e.isModif&&"email"===e.name),o.xp6(3),o.hij(" Adresse: ",e.userAdress," "),o.xp6(5),o.Q6J("ngIf",e.isModif&&"adress"===e.name),o.xp6(9),o.Q6J("ngIf",e.isModif&&"password"===e.name),o.xp6(1),o.Q6J("ngIf",e.errorPassword),o.xp6(1),o.Q6J("ngIf",e.errorServer),o.xp6(1),o.Q6J("ngIf",e.messageSuccess))},directives:[c.O5,i.rH,p.JL,p.sg,p.Fj,p.JJ,p.u],styles:["@media screen and (max-width:550px){h1[_ngcontent-%COMP%]{color:var(--warning);margin-bottom:30px}.container[_ngcontent-%COMP%]{padding:20px;border:1px solid var(--success);border-radius:20px;margin:20px auto;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content}ul[_ngcontent-%COMP%]{width:100%}li[_ngcontent-%COMP%]{margin-bottom:28px}li[_ngcontent-%COMP%], li.profil-item.last-child[_ngcontent-%COMP%]{display:flex;position:relative;justify-content:space-between;font-size:25px;color:var(--warning)}li.profil-item.last-child[_ngcontent-%COMP%]{margin-bottom:35px}li[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-left:auto;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;padding:0 2px}hr[_ngcontent-%COMP%]{color:var(--success);margin-bottom:15px}.flex-center[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:20px}.updateField[_ngcontent-%COMP%]{bottom:-27px}.updateField[_ngcontent-%COMP%], .updateField.last-child[_ngcontent-%COMP%]{position:absolute;width:100%;display:flex}.updateField.last-child[_ngcontent-%COMP%]{bottom:-35px}.updateField[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:8px;padding:0 5px;font-size:18px}.updateField[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:1px solid var(--success);padding:5px 10px;border-radius:20px;color:var(--warning)}.d-flex[_ngcontent-%COMP%]{width:100%}.d-flex[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:auto}#password[_ngcontent-%COMP%]{flex-direction:column}#password[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:1px solid var(--success);border-radius:20px;padding:5px 15px;margin-bottom:5px}#updatePassword[_ngcontent-%COMP%]{width:160px}}@media screen and (min-width:551px){h1[_ngcontent-%COMP%]{color:var(--warning);margin-bottom:30px;font-size:50px}.container[_ngcontent-%COMP%]{padding:20px;border:1px solid var(--success);border-radius:20px;margin:20px auto;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;max-width:550px}ul[_ngcontent-%COMP%]{width:100%}li[_ngcontent-%COMP%]{margin-bottom:28px}li[_ngcontent-%COMP%], li.profil-item.last-child[_ngcontent-%COMP%]{display:flex;position:relative;justify-content:space-between;font-size:25px;color:var(--warning)}li.profil-item.last-child[_ngcontent-%COMP%]{margin-bottom:35px}li[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-left:auto;width:-webkit-fit-content;width:-moz-fit-content;width:fit-content;height:-webkit-fit-content;height:-moz-fit-content;height:fit-content;padding:0 2px}hr[_ngcontent-%COMP%]{color:var(--success);margin-bottom:15px}.flex-center[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:20px}.updateField[_ngcontent-%COMP%]{bottom:-27px}.updateField[_ngcontent-%COMP%], .updateField.last-child[_ngcontent-%COMP%]{position:absolute;width:100%;display:flex}.updateField.last-child[_ngcontent-%COMP%]{bottom:-35px}.updateField[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:8px;padding:0 5px;font-size:18px}.updateField[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:1px solid var(--success);padding:5px 10px;border-radius:20px;color:var(--warning)}.d-flex[_ngcontent-%COMP%]{width:100%}.d-flex[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:auto}#password[_ngcontent-%COMP%]{flex-direction:column}#password[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:1px solid var(--success);border-radius:20px;padding:5px 15px;margin-bottom:5px}#updatePassword[_ngcontent-%COMP%]{width:160px}}"]}),t})()},{path:"list-commande",component:u}];var w=n(5349);let O=(()=>{class t{}return t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({factory:function(e){return new(e||t)},imports:[[i.Bz.forChild(C),w.m]]}),t})()}}]);