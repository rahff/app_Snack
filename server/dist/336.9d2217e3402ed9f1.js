"use strict";(self.webpackChunksnack=self.webpackChunksnack||[]).push([[336],{9336:(y,m,a)=>{a.r(m),a.d(m,{UserModule:()=>q});var l=a(4030),t=a(9863),p=a(8736);let g=(()=>{class n{constructor(e){this.userService=e}canActivate(){return!!this.userService.jwtToken$.value.isAuth}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(p.K))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var f=a(6219),u=a(9808);function _(n,s){if(1&n&&(t.TgZ(0,"div",7),t._uU(1),t.qZA()),2&n){const e=s.$implicit;t.xp6(1),t.AsE("",e.quantity," ",e.product," ")}}function x(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",1),t.TgZ(1,"div",2),t.TgZ(2,"div",3),t._uU(3),t.ALo(4,"date"),t.qZA(),t.TgZ(5,"div",4),t.TgZ(6,"div",5),t._uU(7,"D\xe9tail commande :"),t.qZA(),t.YNc(8,_,2,2,"div",6),t.qZA(),t.TgZ(9,"div",4),t.TgZ(10,"div",5),t._uU(11,"Num\xe9ro de commande :"),t.qZA(),t.TgZ(12,"div",7),t._uU(13),t.qZA(),t.qZA(),t.TgZ(14,"div",4),t.TgZ(15,"div",5),t._uU(16,"Montant :"),t.qZA(),t.TgZ(17,"div",7),t._uU(18),t.qZA(),t.qZA(),t.qZA(),t.TgZ(19,"div",8),t.TgZ(20,"button",9),t.NdJ("click",function(){const o=t.CHM(e).index;return t.oxw().refreshCommande(o)}),t._uU(21,"Commander \xe0 nouveau"),t.qZA(),t.qZA(),t.qZA()}if(2&n){const e=s.$implicit;t.xp6(3),t.hij("commande du ",t.xi3(4,4,e.date,"dd/MM/yyyy")," "),t.xp6(5),t.Q6J("ngForOf",e.detail),t.xp6(5),t.hij(" ",e.numeroCommande," "),t.xp6(5),t.hij("",e.montant," \u20ac")}}let h=(()=>{class n{constructor(e,i,r){this.userService=e,this.cartService=i,this.router=r,this.commandes=[]}ngOnInit(){this.subscription=this.userService.currentUser$.subscribe(e=>{this.commandes=e.commandes,console.log("commandes",e.commandes)})}refreshCommande(e){this.cartService.refreshCommande(this.commandes[e].detail),this.router.navigate(["/page-menu/panier"])}ngOnDestroy(){this.subscription.unsubscribe()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p.K),t.Y36(f.N),t.Y36(l.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-list-commande-user"]],decls:3,vars:1,consts:[["class","container",4,"ngFor","ngForOf"],[1,"container"],[1,"flex-col","w-100"],[1,"date"],[1,"row"],[1,"label"],["class","detail",4,"ngFor","ngForOf"],[1,"detail"],[1,"action"],[1,"btn","success",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"h1"),t._uU(1,"Historique de vos commandes"),t.qZA(),t.YNc(2,x,22,7,"div",0)),2&e&&(t.xp6(2),t.Q6J("ngForOf",i.commandes))},directives:[u.sg],pipes:[u.uU],styles:["@media screen and (min-width:551px){.container[_ngcontent-%COMP%]{padding:25px;border:1px solid var(--success);border-radius:20px;margin-bottom:15px;font-size:28px;position:relative}.date[_ngcontent-%COMP%]{margin:0 auto 20px;padding:10px 0;width:70%;display:flex;justify-content:center;align-items:center}.row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin-bottom:5px}.label[_ngcontent-%COMP%], .detail[_ngcontent-%COMP%]{padding:15px}.detail[_ngcontent-%COMP%]{border:1px solid var(--success);border-radius:20px;margin-right:2px;margin-bottom:2px}h1[_ngcontent-%COMP%]{color:var(--warning);font-size:50px;margin-bottom:45px}.vide[_ngcontent-%COMP%]{font-size:35px;text-align:center;padding:30px}.action[_ngcontent-%COMP%]{margin:15px auto 0;display:flex;justify-content:flex-end;align-items:flex-end}.action[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:25px}}@media screen and (max-width:551px){.container[_ngcontent-%COMP%]{padding:20px;border:1px solid var(--success);border-radius:20px;margin-bottom:15px;font-size:20px;position:relative}.date[_ngcontent-%COMP%]{margin:0 auto 20px;padding:10px 0;width:70%;display:flex;justify-content:center;align-items:center}.row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin-bottom:5px;width:100%}.label[_ngcontent-%COMP%], .detail[_ngcontent-%COMP%]{padding:10px}.detail[_ngcontent-%COMP%]{border:1px solid var(--success);border-radius:20px;margin-right:2px;margin-bottom:2px}h1[_ngcontent-%COMP%]{color:var(--warning);font-size:50px;margin-bottom:45px}.vide[_ngcontent-%COMP%]{font-size:35px;text-align:center;padding:20px}.action[_ngcontent-%COMP%]{margin:15px auto 0;display:flex;justify-content:flex-end;align-items:flex-end;position:absolute;bottom:10px;right:10px}.action[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:20px}}"]}),n})();var c=a(4182),C=a(3213);const v=["newName"];function b(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",17),t._UZ(1,"input",18,19),t.TgZ(3,"button",20),t.NdJ("click",function(){return t.CHM(e),t.oxw().submitOneField("name",0)}),t._uU(4,"Ok"),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(1),t.s9C("value",e.userName)}}function Z(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",17),t._UZ(1,"input",18,19),t.TgZ(3,"button",20),t.NdJ("click",function(){return t.CHM(e),t.oxw().submitOneField("firstname",1)}),t._uU(4,"Ok"),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(1),t.s9C("value",e.userFirstname)}}function P(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",17),t._UZ(1,"input",18,19),t.TgZ(3,"button",20),t.NdJ("click",function(){return t.CHM(e),t.oxw().submitOneField("email",2)}),t._uU(4,"Ok"),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(1),t.s9C("value",e.userEmail)}}function M(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",21),t._UZ(1,"input",18,19),t.TgZ(3,"button",20),t.NdJ("click",function(){return t.CHM(e),t.oxw().submitOneField("adress",3)}),t._uU(4,"Ok"),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(1),t.s9C("value",e.userAdress)}}function w(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",12),t.TgZ(1,"div",22),t.TgZ(2,"label"),t._uU(3,"Mot de passe"),t.qZA(),t._UZ(4,"input",23),t.TgZ(5,"label"),t._uU(6,"Nouveau mot de passe"),t.qZA(),t._UZ(7,"input",24),t.TgZ(8,"label"),t._uU(9,"Confirmer"),t.qZA(),t.TgZ(10,"input",25),t.NdJ("input",function(){return t.CHM(e),t.oxw().errorPassword=!1}),t.qZA(),t.TgZ(11,"button",26),t.NdJ("click",function(){return t.CHM(e),t.oxw().submitOneField("password",4)}),t._uU(12,"Modifier le mot de passe"),t.qZA(),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.updatePasswordForm)}}function O(n,s){1&n&&(t.TgZ(0,"p",27),t._uU(1,"Les mots de passe sont diff\xe9rents"),t.qZA())}function T(n,s){if(1&n&&(t.TgZ(0,"p",27),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Oqu(e.errorServer)}}function A(n,s){if(1&n&&(t.TgZ(0,"p",27),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",e.messageSuccess," ")}}const U=[{path:"",canActivate:[g],component:(()=>{class n{constructor(e,i,r){this.userService=e,this.fb=i,this.alertService=r,this.isModif=!1,this.errorPassword=!1}ngOnInit(){this.userService.getCurrentUser().subscribe(e=>{this.userName=e.name,this.userFirstname=e.firstname,this.userAdress=e.adress,this.userEmail=e.email,this.userId=e._id}),this.initForm()}updateField(e,i){const r=document.querySelectorAll(".se");if(this.isModif){this.name=void 0,this.isModif=!1;for(let o=0;o<5;o++)r[o].innerHTML="Modifier <i class='bi bi-pencil-fill'></i>",r[o].removeAttribute("disabled")}else{this.name=e,this.isModif=!this.isModif;for(let o=0;o<5;o++)r[o].innerHTML=o===i?"Annuler <i class='bi bi-skip-backward-btn'></i>":"Modifier <i class='bi bi-pencil-fill'></i>",o!==i&&r[o].setAttribute("disabled","true")}}submitOneField(e,i){if("password"===e){if(this.updatePasswordForm.get("new").value!==this.updatePasswordForm.get("confirm").value)return void(this.errorPassword=!0);const o={old:this.updatePasswordForm.get("old").value,new:this.updatePasswordForm.get("new").value,email:this.userEmail};return console.log(this.userId),this.userService.updateOneField(this.userId,e,o).then(d=>{this.alertService.makeSimpleAlert(d.message,"success",1800)}).catch(d=>{this.alertService.makeSimpleAlert(d,"error",1800)}),void this.updateField(e,i)}this.userService.updateOneField(this.userId,e,{update:this.newName.nativeElement.value}).then(o=>{const d={email:o.result.local.email,name:o.result.name,adress:o.result.adress,firstname:o.result.firstname,role:o.result.role,confirm:o.result.confirm,_id:o.result._id};this.userService.currentUser$.next(d),this.userName=d.name,this.userFirstname=d.firstname,this.userAdress=d.adress,this.userEmail=d.email,this.alertService.makeSimpleAlert(o.message,"success",1800)}).catch(o=>(console.log("echec"),this.alertService.makeSimpleAlert(o,"error",1800),o)),this.updateField(e,i)}initForm(){this.updatePasswordForm=this.fb.group({old:["",c.kI.required],new:["",c.kI.required,c.kI.minLength(6)],confirm:["",c.kI.required]})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p.K),t.Y36(c.qu),t.Y36(C.c))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-profil"]],viewQuery:function(e,i){if(1&e&&t.Gf(v,5),2&e){let r;t.iGM(r=t.CRH())&&(i.newName=r.first)}},decls:51,vars:12,consts:[[1,"container"],[1,"profil-item"],[1,"btn","success","se",3,"click"],["butt1",""],[1,"bi","bi-pencil-fill"],["class","updateField",4,"ngIf"],["butt2",""],["butt3",""],[1,"profil-item","last-child"],["butt4",""],["class","updateField last-child",4,"ngIf"],["id","password",1,"profil-item"],[1,"d-flex"],["class","d-flex",4,"ngIf"],["class","error",4,"ngIf"],[1,"flex-center"],["routerLink","list-commande",1,"btn","success"],[1,"updateField"],["type","text",3,"value"],["newName",""],[1,"btn","btn-danger",3,"click"],[1,"updateField","last-child"],[1,"flex-col",3,"formGroup"],["type","password","value","","formControlName","old"],["type","password","value","","formControlName","new"],["type","password","value","","formControlName","confirm",3,"input"],["id","updatePassword",1,"btn","btn-danger",3,"click"],[1,"error"]],template:function(e,i){1&e&&(t.TgZ(0,"h1"),t._uU(1,"Votre Profil Client"),t.qZA(),t.TgZ(2,"div",0),t.TgZ(3,"ul"),t.TgZ(4,"li",1),t._uU(5),t.TgZ(6,"button",2,3),t.NdJ("click",function(){return i.updateField("name",0)}),t._uU(8," Modifier "),t._UZ(9,"i",4),t.qZA(),t.YNc(10,b,5,1,"div",5),t.qZA(),t._UZ(11,"hr"),t.TgZ(12,"li",1),t._uU(13),t.TgZ(14,"button",2,6),t.NdJ("click",function(){return i.updateField("firstname",1)}),t._uU(16," Modifier "),t._UZ(17,"i",4),t.qZA(),t.YNc(18,Z,5,1,"div",5),t.qZA(),t._UZ(19,"hr"),t.TgZ(20,"li",1),t._uU(21),t.TgZ(22,"button",2,7),t.NdJ("click",function(){return i.updateField("email",2)}),t._uU(24," Modifier "),t._UZ(25,"i",4),t.qZA(),t.YNc(26,P,5,1,"div",5),t.qZA(),t._UZ(27,"hr"),t.TgZ(28,"li",8),t._uU(29),t.TgZ(30,"button",2,9),t.NdJ("click",function(){return i.updateField("adress",3)}),t._uU(32," Modifier"),t._UZ(33,"i",4),t.qZA(),t.YNc(34,M,5,1,"div",10),t.qZA(),t._UZ(35,"hr"),t.TgZ(36,"li",11),t.TgZ(37,"div",12),t._uU(38,"Mot de passe: ******** "),t.TgZ(39,"button",2,7),t.NdJ("click",function(){return i.updateField("password",4)}),t._uU(41," Modifier "),t._UZ(42,"i",4),t.qZA(),t.qZA(),t.YNc(43,w,13,1,"div",13),t.YNc(44,O,2,0,"p",14),t.YNc(45,T,2,1,"p",14),t.YNc(46,A,2,1,"p",14),t.qZA(),t._UZ(47,"hr"),t.TgZ(48,"div",15),t.TgZ(49,"button",16),t._uU(50,"Historique des commandes"),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(5),t.hij(" Nom: ",i.userName," "),t.xp6(5),t.Q6J("ngIf",i.isModif&&"name"===i.name),t.xp6(3),t.hij(" Pr\xe9nom: ",i.userFirstname,""),t.xp6(5),t.Q6J("ngIf",i.isModif&&"firstname"===i.name),t.xp6(3),t.hij(" Email: ",i.userEmail,""),t.xp6(5),t.Q6J("ngIf",i.isModif&&"email"===i.name),t.xp6(3),t.hij(" Adresse: ",i.userAdress," "),t.xp6(5),t.Q6J("ngIf",i.isModif&&"adress"===i.name),t.xp6(9),t.Q6J("ngIf",i.isModif&&"password"===i.name),t.xp6(1),t.Q6J("ngIf",i.errorPassword),t.xp6(1),t.Q6J("ngIf",i.errorServer),t.xp6(1),t.Q6J("ngIf",i.messageSuccess))},directives:[u.O5,l.rH,c.JL,c.sg,c.Fj,c.JJ,c.u],styles:["@media screen and (max-width: 550px){h1[_ngcontent-%COMP%]{color:var(--warning);margin-bottom:30px}.container[_ngcontent-%COMP%]{padding:20px;border:1px solid var(--success);border-radius:20px;margin:20px auto;height:-moz-fit-content;height:fit-content}ul[_ngcontent-%COMP%]{width:100%}li[_ngcontent-%COMP%]{display:flex;position:relative;justify-content:space-between;font-size:25px;margin-bottom:28px;color:var(--warning)}li.profil-item.last-child[_ngcontent-%COMP%]{display:flex;position:relative;justify-content:space-between;font-size:25px;margin-bottom:35px;color:var(--warning)}li[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-left:auto;width:-moz-fit-content;width:fit-content;height:-moz-fit-content;height:fit-content;padding:0 2px}hr[_ngcontent-%COMP%]{color:var(--success);margin-bottom:15px}.flex-center[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:20px}.updateField[_ngcontent-%COMP%]{position:absolute;width:100%;bottom:-27px;display:flex}.updateField.last-child[_ngcontent-%COMP%]{position:absolute;width:100%;bottom:-35px;display:flex}.updateField[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:8px;padding:0 5px;font-size:18px}.updateField[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:1px solid var(--success);padding:5px 10px;border-radius:20px;color:var(--warning)}.d-flex[_ngcontent-%COMP%]{width:100%}.d-flex[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:auto}#password[_ngcontent-%COMP%]{flex-direction:column}#password[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:1px solid var(--success);border-radius:20px;padding:5px 15px;margin-bottom:5px}#updatePassword[_ngcontent-%COMP%]{width:160px}}@media screen and (min-width: 551px){h1[_ngcontent-%COMP%]{color:var(--warning);margin-bottom:30px;font-size:50px}.container[_ngcontent-%COMP%]{padding:20px;border:1px solid var(--success);border-radius:20px;margin:20px auto;height:-moz-fit-content;height:fit-content;max-width:550px}ul[_ngcontent-%COMP%]{width:100%}li[_ngcontent-%COMP%]{display:flex;position:relative;justify-content:space-between;font-size:25px;margin-bottom:28px;color:var(--warning)}li.profil-item.last-child[_ngcontent-%COMP%]{display:flex;position:relative;justify-content:space-between;font-size:25px;margin-bottom:35px;color:var(--warning)}li[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-left:auto;width:-moz-fit-content;width:fit-content;height:-moz-fit-content;height:fit-content;padding:0 2px}hr[_ngcontent-%COMP%]{color:var(--success);margin-bottom:15px}.flex-center[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:20px}.updateField[_ngcontent-%COMP%]{position:absolute;width:100%;bottom:-27px;display:flex}.updateField.last-child[_ngcontent-%COMP%]{position:absolute;width:100%;bottom:-35px;display:flex}.updateField[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:8px;padding:0 5px;font-size:18px}.updateField[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:1px solid var(--success);padding:5px 10px;border-radius:20px;color:var(--warning)}.d-flex[_ngcontent-%COMP%]{width:100%}.d-flex[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:auto}#password[_ngcontent-%COMP%]{flex-direction:column}#password[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:1px solid var(--success);border-radius:20px;padding:5px 15px;margin-bottom:5px}#updatePassword[_ngcontent-%COMP%]{width:160px}}"]}),n})()},{path:"list-commande",component:h}];var F=a(5349);let q=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[l.Bz.forChild(U),F.m]]}),n})()}}]);